<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introducing stats19 • stats19</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introducing stats19">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stats19</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/stats19.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/blog.html">stats19: a package for road safety research</a>
    </li>
    <li>
      <a href="../articles/stats19-training-setup.html">An introduction to road safety analysis with R: setup notes</a>
    </li>
    <li>
      <a href="../articles/stats19-training.html">Introduction to R for road safety: an introduction to R and practical exercises</a>
    </li>
    <li>
      <a href="../articles/stats19-vehicles.html">Researching vehicles involved in collisions with STATS19 data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ropensci/stats19">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introducing stats19</h1>
                        <h4 class="author">R Lovelace, M Morgan, L Hama and M Padgham</h4>
            
            <h4 class="date">2020-01-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/stats19/blob/master/vignettes/stats19.Rmd"><code>vignettes/stats19.Rmd</code></a></small>
      <div class="hidden name"><code>stats19.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p><strong>stats19</strong> enables access to and processing of Great Britain’s official road traffic casualty database, <a href="https://data.gov.uk/dataset/cb7ae6f0-4be6-4935-9277-47e5ce24a11f/road-safety-data">STATS19</a>. A description of variables in the database can be found in a <a href="http://data.dft.gov.uk/road-accidents-safety-data/Brief-guide-to%20road-accidents-and-safety-data.doc">document</a> provided by the UK’s Department for Transport (DfT). The datasets are collectively called STATS19 after the form used to report them, which can be found <a href="https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/230590/stats19.pdf">here</a>. This vignette focuses on how to use the <strong>stats19</strong> package to work with STATS19 data.</p>
<p><strong>Note</strong>: The Department for Transport refers to “accidents”, but “crashes” is a more appropriate term, as emphasised in the “crash not accident” arguments of road safety advocacy groups such as <a href="http://www.roadpeace.org/take-action/crash-not-accident/">RoadPeace</a>. We use the term “accidents” only in reference to nomenclature within the data as provided.</p>
<p>The development version is hosted on <a href="https://github.com/ITSLeeds/stats19">GitHub</a> and can be installed and loaded as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># from CRAN</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"stats19"</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co"># you can install the latest development (discoraged) using:</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">remotes<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/remotes/man/install_github.html">install_github</a></span>(<span class="st">"ITSLeeds/stats19"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(stats19)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; Data provided under OGL v3.0. Cite the source and link to:</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt; www.nationalarchives.gov.uk/doc/open-government-licence/version/3/</span></a></code></pre></div>
</div>
<div id="functions" class="section level2">
<h2 class="hasAnchor">
<a href="#functions" class="anchor"></a>Functions</h2>
<p>The easiest way to get STATS19 data is with <code><a href="../reference/get_stats19.html">get_stats19()</a></code>. This function takes 2 main arguments, <code>year</code> and <code>type</code>. The year can be any year between 1979 and 2017. The type can be one of <code>accidents</code>, <code>casualties</code> and <code>vehicles</code>, described below. <code><a href="../reference/get_stats19.html">get_stats19()</a></code> performs 3 jobs, corresponding to three main types of functions:</p>
<ul>
<li><p><strong>Download</strong>: A <code><a href="../reference/dl_stats19.html">dl_stats19()</a></code> function accepts <code>year</code>, <code>type</code> and <code>filename</code> arguments to make it easy to find the right file to download only.</p></li>
<li>
<p><strong>Read</strong>: STATS19 data is provided in a particular format that benefits from being read-in with pre-specified column types. This is taken care of with <code>read_*()</code> functions providing access to the 3 main tables in STATS19 data:</p>
<ul>
<li>
<code><a href="../reference/read_accidents.html">read_accidents()</a></code> reads-in the crash data (which has one row per incident)</li>
<li>
<code><a href="../reference/read_casualties.html">read_casualties()</a></code> reads-in the casualty data (which has one row per person injured or killed)</li>
<li>
<code><a href="../reference/read_vehicles.html">read_vehicles()</a></code> reads-in the vehicles table, which contains information on the vehicles involved in the crashes (and has one row per vehicle)</li>
</ul>
</li>
<li><p><strong>Format</strong>: There are corresponding <code>format_*()</code> functions for each of the <code>read_*()</code> functions. These have been exported for convenience, as the two sets of functions are closely related, there is also a <code>format</code> parameter for the <code>read_*()</code> functions, which by default is <code>TRUE</code>, adds labels to the tables. The raw data provided by the DfT contains only integers. Running <code>read_*(..., format = TRUE)</code> converts these integer values to the corresponding character variables for each of the three tables. For example, <code><a href="../reference/read_accidents.html">read_accidents(format = TRUE)</a></code> converts values in the <code>accident_severity</code> column from <code>1</code>, <code>2</code> and <code>3</code> to <code>Slight</code>, <code>Serious</code> and <code>Fatal</code> using <code>fromat_accidents()</code> function. To read-in raw data without formatting, set <code>format = FALSE</code>.</p></li>
</ul>
<p>Multiple functions (<code>read_*</code> and <code>format_*</code>) are needed for each step because of the structure of STATS19 data, which are divided into 3 tables, as described in an article that analyses 2005-2015 STATS19 data with reproducible R code by Christoph Freier (<a href="https://kawameicha.gitlab.io/inCodeWeTrust/2018/01/10-years-and-3.3-million-accidented-vehicles-in-the-uk/">2018</a>):</p>
<ol style="list-style-type: decimal">
<li>"accident circumstances, with details about location, severity, weather, etc.;</li>
<li>casualties, referencing knowledge about the victims; and</li>
<li>vehicles, which contains more information about the vehicle type and manoeuvres, as well the some information about the driver."</li>
</ol>
<p>The data can be downloaded for many years. Datasets since 1979 are broadly consistent, meaning that STATS19 data represents a very rich historic geographic, as stated in the DfT’s road casualties report in <a href="https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/744077/reported-road-casualties-annual-report-2017.pdf">2017</a>:</p>
<blockquote>
<p>The current set of definitions and detail of information goes back to 1979, providing a long period for comparison.</p>
</blockquote>
</div>
<div id="download-stats19-data" class="section level2">
<h2 class="hasAnchor">
<a href="#download-stats19-data" class="anchor"></a>Download STATS19 data</h2>
<p><strong>stats19</strong> enables download of raw STATS19 data with <code>dl_*</code> functions. The following code chunk, for example, downloads and unzips a .zip file containing STATS19 data from 2017:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="../reference/dl_stats19.html">dl_stats19</a></span>(<span class="dt">year =</span> <span class="dv">2017</span>, <span class="dt">type =</span> <span class="st">"Accidents"</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt; Files identified: dftRoadSafetyData_Accidents_2017.zip</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt;    http://data.dft.gov.uk.s3.amazonaws.com/road-accidents-safety-data/dftRoadSafetyData_Accidents_2017.zip</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; Attempt downloading from:</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt; Data saved at /tmp/RtmpglohrO/dftRoadSafetyData_Accidents_2017/Acc.csv</span></a></code></pre></div>
<p>Note that in the previous command, <code>ask = FALSE</code>, meaning you will not be asked. By default you are asked to confirm, before downloading large files. Currently, these files are downloaded to a default location of <code>tempdir</code> which is a platform independent “safe” but temporary location to download the data in. Once downloaded, they are unzipped under original DfT file names. The <code><a href="../reference/dl_stats19.html">dl_stats19()</a></code> function prints out the location and final file name(s) of unzipped files(s) as shown above.</p>
<p><code><a href="../reference/dl_stats19.html">dl_stats19()</a></code> takes three parameters. Supplying a <code>file_name</code> is interpreted to mean that the user is aware of what to download and the other two parameters will be ignored. You can also use <code>years</code> and <code>type</code> to “search” through the file names, which are stored in a lazy-loaded dataset called <code><a href="../reference/file_names.html">stats19::file_names</a></code>.</p>
<p>You can find out the names of files that can be downloaded with <code><a href="https://rdrr.io/r/base/names.html">names(stats19::file_names)</a></code>, an example of which is shown below:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">stats19<span class="op">::</span>file_names<span class="op">$</span>dftRoadSafetyData_Vehicles_<span class="fl">2017.</span>zip</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt; [1] "dftRoadSafetyData_Vehicles_2017.zip"</span></a></code></pre></div>
<p>To see how <code>file_names</code> was created, see <code><a href="../reference/file_names.html">?file_names</a></code>. Data files from other years can be selected interactively. Just providing a year, for example, presents the user with multiple options (from <code>file_names</code>), illustrated below:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="../reference/dl_stats19.html">dl_stats19</a></span>(<span class="dt">year =</span> <span class="dv">2017</span>)</a></code></pre></div>
<pre><code>Multiple matches. Which do you want to download?

1: dftRoadSafetyData_Vehicles_2017.zip
2: dftRoadSafetyData_Casualties_2017.zip
3: dftRoadSafetyData_Accidents_2017.zip

Selection: 
Enter an item from the menu, or 0 to exit</code></pre>
<p>When R is running interactively, you can select which of the 3 matching files to download: those relating to vehicles, casualties or accidents in 2017. You can also search for file names, as illustrated below:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">d17 =<span class="st"> "dftRoadSafetyData_Accidents_2017"</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw"><a href="../reference/dl_stats19.html">dl_stats19</a></span>(<span class="dt">file_name =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(d17, <span class="st">".zip"</span>))</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt; Files identified: dftRoadSafetyData_Accidents_2017.zip</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt;    http://data.dft.gov.uk.s3.amazonaws.com/road-accidents-safety-data/dftRoadSafetyData_Accidents_2017.zip</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt; Data already exists in data_dir, not downloading</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt; Data saved at /tmp/RtmpglohrO/dftRoadSafetyData_Accidents_2017/Acc.csv</span></a></code></pre></div>
<p>Note that this is the same file (containing the ‘accidents’ table from 2017) downloaded previously with the command <code><a href="../reference/dl_stats19.html">dl_stats19(year = 2017, type = "Accidents")</a></code>. If the file is already present, <code><a href="../reference/dl_stats19.html">dl_stats19()</a></code> will skip the download process.</p>
</div>
<div id="read-stats19-data" class="section level2">
<h2 class="hasAnchor">
<a href="#read-stats19-data" class="anchor"></a>Read STATS19 data</h2>
<p>In a similar approach to the download section before, we can read files downloaded using a <code>data_dir</code> location of the file and the <code>filename</code> to read. The code below will download the <code>dftRoadSafetyData_Accidents_2017.zip</code> file from the DfT servers and read its content. Files are saved by default in <code><a href="https://rdrr.io/r/base/tempfile.html">tempdir()</a></code>, but this can be overridden to ensure permanent storage in a user-defined location.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">d17 =<span class="st"> "dftRoadSafetyData_Accidents_2017"</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw"><a href="../reference/dl_stats19.html">dl_stats19</a></span>(<span class="dt">file_name =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(d17, <span class="st">".zip"</span>))</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; Files identified: dftRoadSafetyData_Accidents_2017.zip</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt;    http://data.dft.gov.uk.s3.amazonaws.com/road-accidents-safety-data/dftRoadSafetyData_Accidents_2017.zip</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt; Data already exists in data_dir, not downloading</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; Data saved at /tmp/RtmpglohrO/dftRoadSafetyData_Accidents_2017/Acc.csv</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7">crashes_<span class="dv">2017</span>_raw =<span class="st"> </span><span class="kw"><a href="../reference/read_accidents.html">read_accidents</a></span>(<span class="dt">data_dir =</span> <span class="kw"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span>(),</a>
<a class="sourceLine" id="cb8-8" data-line-number="8">                                  <span class="dt">year =</span> <span class="dv">2017</span>,</a>
<a class="sourceLine" id="cb8-9" data-line-number="9">                                  <span class="dt">filename =</span> <span class="st">"Acc.csv"</span>)</a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt; Reading in:</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt; /tmp/RtmpglohrO/dftRoadSafetyData_Accidents_2017/Acc.csv</span></a></code></pre></div>
<p><strong>stats19</strong> imports data with <code><a href="https://readr.tidyverse.org/reference/read_delim.html">readr::read_csv()</a></code> which results in a ‘tibble’ object: a data frame with more user-friendly printing and a few other features.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span>(crashes_<span class="dv">2017</span>_raw)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">#&gt; [1] "spec_tbl_df" "tbl_df"      "tbl"         "data.frame"</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(crashes_<span class="dv">2017</span>_raw)</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; [1] 129982     32</span></a></code></pre></div>
<p>There are three <code>read_*()</code> functions, corresponding to the three different classes of data provided by the DfT: 1. <code><a href="../reference/read_accidents.html">read_accidents()</a></code> 2. <code><a href="../reference/read_casualties.html">read_casualties()</a></code> 3. <code><a href="../reference/read_vehicles.html">read_vehicles()</a></code></p>
<p>In all cases, a default parameter <code>read_*(format = TRUE)</code> returns the data in formatted form, as described above. Data can also be imported in the form directly provided by the DfT by passing <code>format = FALSE</code>, and then subsequently formatted with additional <code>format_*()</code> functions, as described in a final section of this vignette. Each of these <code>read_*()</code> functions is now described in more detail.</p>
<div id="crash-data" class="section level3">
<h3 class="hasAnchor">
<a href="#crash-data" class="anchor"></a>Crash data</h3>
<p>After raw data files have been downloaded as described in the previous section, they can then be read-in as follows:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">crashes_<span class="dv">2017</span>_raw =<span class="st"> </span><span class="kw"><a href="../reference/read_accidents.html">read_accidents</a></span>(<span class="dt">year =</span> <span class="dv">2017</span>, <span class="dt">format =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt; Reading in:</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt; /tmp/RtmpglohrO/dftRoadSafetyData_Accidents_2017/Acc.csv</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4">crashes_<span class="dv">2017</span> =<span class="st"> </span><span class="kw"><a href="../reference/format_accidents.html">format_accidents</a></span>(crashes_<span class="dv">2017</span>_raw)</a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(crashes_<span class="dv">2017</span>_raw)</a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt; [1] 129982</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(crashes_<span class="dv">2017</span>_raw)</a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt; [1] 32</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(crashes_<span class="dv">2017</span>)</a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt; [1] 129982</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(crashes_<span class="dv">2017</span>)</a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt; [1] 32</span></a></code></pre></div>
<p>What just happened? We read-in data on all road crashes recorded by the police in 2017 across Great Britain. The dataset contains 32 columns (variables) for 129,982 crashes.</p>
<p>This work was done by <code><a href="../reference/read_accidents.html">read_accidents(format = FALSE)</a></code>, which imported the “raw” STATS19 data without cleaning messy column names or re-categorising the outputs. <code><a href="../reference/format_accidents.html">format_accidents()</a></code> function automates the process of matching column names with variable names and labels in a <a href="http://data.dft.gov.uk/road-accidents-safety-data/Road-Accident-Safety-Data-Guide.xls"><code>.xls</code> file</a> provided by the DfT. This means <code>crashes_2017</code> is much more usable than <code>crashes_2017_raw</code>, as shown below, which shows some key variables in the messy and clean datasets:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">crashes_<span class="dv">2017</span>_raw[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">23</span>, <span class="dv">25</span>)]</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#&gt; # A tibble: 129,982 x 4</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&gt;    Accident_Severity Speed_limit `Pedestrian_Crossing-Human_Co… Light_Conditions</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&gt;                &lt;int&gt;       &lt;int&gt;                          &lt;int&gt;            &lt;int&gt;</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt;  1                 1          30                              0                4</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt;  2                 3          30                              0                4</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt;  3                 3          30                              0                4</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&gt;  4                 3          30                              0                4</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">#&gt;  5                 2          20                              0                4</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#&gt;  6                 3          30                              0                4</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">#&gt;  7                 3          40                              0                4</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#&gt;  8                 3          30                              2                4</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="co">#&gt;  9                 2          50                              0                4</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="co">#&gt; 10                 2          30                              0                4</span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="co">#&gt; # … with 129,972 more rows</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16">crashes_<span class="dv">2017</span>[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">23</span>, <span class="dv">25</span>)]</a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="co">#&gt; # A tibble: 129,982 x 4</span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="co">#&gt;    accident_severity speed_limit pedestrian_crossing_human_… light_conditions   </span></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"><span class="co">#&gt;    &lt;chr&gt;                   &lt;int&gt; &lt;chr&gt;                       &lt;chr&gt;              </span></a>
<a class="sourceLine" id="cb11-20" data-line-number="20"><span class="co">#&gt;  1 Fatal                      30 None within 50 metres       Darkness - lights …</span></a>
<a class="sourceLine" id="cb11-21" data-line-number="21"><span class="co">#&gt;  2 Slight                     30 None within 50 metres       Darkness - lights …</span></a>
<a class="sourceLine" id="cb11-22" data-line-number="22"><span class="co">#&gt;  3 Slight                     30 None within 50 metres       Darkness - lights …</span></a>
<a class="sourceLine" id="cb11-23" data-line-number="23"><span class="co">#&gt;  4 Slight                     30 None within 50 metres       Darkness - lights …</span></a>
<a class="sourceLine" id="cb11-24" data-line-number="24"><span class="co">#&gt;  5 Serious                    20 None within 50 metres       Darkness - lights …</span></a>
<a class="sourceLine" id="cb11-25" data-line-number="25"><span class="co">#&gt;  6 Slight                     30 None within 50 metres       Darkness - lights …</span></a>
<a class="sourceLine" id="cb11-26" data-line-number="26"><span class="co">#&gt;  7 Slight                     40 None within 50 metres       Darkness - lights …</span></a>
<a class="sourceLine" id="cb11-27" data-line-number="27"><span class="co">#&gt;  8 Slight                     30 Control by other authorise… Darkness - lights …</span></a>
<a class="sourceLine" id="cb11-28" data-line-number="28"><span class="co">#&gt;  9 Serious                    50 None within 50 metres       Darkness - lights …</span></a>
<a class="sourceLine" id="cb11-29" data-line-number="29"><span class="co">#&gt; 10 Serious                    30 None within 50 metres       Darkness - lights …</span></a>
<a class="sourceLine" id="cb11-30" data-line-number="30"><span class="co">#&gt; # … with 129,972 more rows</span></a></code></pre></div>
<p>By default, <code>format = TRUE</code>, meaning that the two stages of <code><a href="../reference/read_accidents.html">read_accidents(format = FALSE)</a></code> and <code><a href="../reference/format_accidents.html">format_accidents()</a></code> yield the same result as <code><a href="../reference/read_accidents.html">read_accidents(format = TRUE)</a></code>. For the full list of columns, run <code><a href="https://rdrr.io/r/base/names.html">names(crashes_2017)</a></code>.</p>
<!-- This means `crashes_2017` is much more usable than `crashes_2017_raw`, as shown below, which shows three records and some key variables in the messy and clean datasets: -->
<p><strong>Note</strong>: As indicated above, the term “accidents” is only used as directly provided by the DfT; “crashes” is a more appropriate term, hence we call our resultant datasets <code>crashes_*</code>.</p>
</div>
</div>
<div id="format-stats19-data" class="section level2">
<h2 class="hasAnchor">
<a href="#format-stats19-data" class="anchor"></a>Format STATS19 data</h2>
<p>It is also possible to import the “raw” data as provided by the DfT. A <a href="http://data.dft.gov.uk/road-accidents-safety-data/Road-Accident-Safety-Data-Guide.xls"><code>.xls</code> file</a> provided by the DfT defines the column names for the datasets provided. The packaged datasets <code>stats19_variables</code> and <code>stats19_schema</code> provide summary information about the contents of this data guide. These contain the full variable names in the guide (<code>stats19_variables</code>) and a complete look up table relating integer values to the <code>.csv</code> files provided by the DfT and their labels (<code>stats19_schema</code>). The first rows of each dataset are shown below:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">stats19_variables</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#&gt; # A tibble: 70 x 4</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">#&gt;    table     variable                              type     column_name         </span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">#&gt;    &lt;chr&gt;     &lt;chr&gt;                                 &lt;chr&gt;    &lt;chr&gt;               </span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&gt;  1 accidents Accident Index                        other    accident_index      </span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#&gt;  2 accidents Police Force                          charact… police_force        </span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&gt;  3 accidents Accident Severity                     charact… accident_severity   </span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#&gt;  4 accidents Number of Vehicles                    numeric  number_of_vehicles  </span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">#&gt;  5 accidents Number of Casualties                  numeric  number_of_casualties</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">#&gt;  6 accidents Date (DD/MM/YYYY)                     date     date                </span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">#&gt;  7 accidents Day of Week                           charact… day_of_week         </span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co">#&gt;  8 accidents Time (HH:MM)                          time     time                </span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co">#&gt;  9 accidents Location Easting OSGR (Null if not k… location location_easting_os…</span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co">#&gt; 10 accidents Location Northing OSGR (Null if not … location location_northing_o…</span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="co">#&gt; # … with 60 more rows</span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16">stats19_schema</a>
<a class="sourceLine" id="cb12-17" data-line-number="17"><span class="co">#&gt; # A tibble: 980 x 4</span></a>
<a class="sourceLine" id="cb12-18" data-line-number="18"><span class="co">#&gt;    code  label               variable     variable_formatted</span></a>
<a class="sourceLine" id="cb12-19" data-line-number="19"><span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt;               &lt;chr&gt;        &lt;chr&gt;             </span></a>
<a class="sourceLine" id="cb12-20" data-line-number="20"><span class="co">#&gt;  1 1     Metropolitan Police Police Force police_force      </span></a>
<a class="sourceLine" id="cb12-21" data-line-number="21"><span class="co">#&gt;  2 3     Cumbria             Police Force police_force      </span></a>
<a class="sourceLine" id="cb12-22" data-line-number="22"><span class="co">#&gt;  3 4     Lancashire          Police Force police_force      </span></a>
<a class="sourceLine" id="cb12-23" data-line-number="23"><span class="co">#&gt;  4 5     Merseyside          Police Force police_force      </span></a>
<a class="sourceLine" id="cb12-24" data-line-number="24"><span class="co">#&gt;  5 6     Greater Manchester  Police Force police_force      </span></a>
<a class="sourceLine" id="cb12-25" data-line-number="25"><span class="co">#&gt;  6 7     Cheshire            Police Force police_force      </span></a>
<a class="sourceLine" id="cb12-26" data-line-number="26"><span class="co">#&gt;  7 10    Northumbria         Police Force police_force      </span></a>
<a class="sourceLine" id="cb12-27" data-line-number="27"><span class="co">#&gt;  8 11    Durham              Police Force police_force      </span></a>
<a class="sourceLine" id="cb12-28" data-line-number="28"><span class="co">#&gt;  9 12    North Yorkshire     Police Force police_force      </span></a>
<a class="sourceLine" id="cb12-29" data-line-number="29"><span class="co">#&gt; 10 13    West Yorkshire      Police Force police_force      </span></a>
<a class="sourceLine" id="cb12-30" data-line-number="30"><span class="co">#&gt; # … with 970 more rows</span></a></code></pre></div>
<p>The code that generated these small datasets can be found in their help pages (accessed with <code><a href="../reference/stats19_schema.html">?stats19_variables</a></code> and <code><a href="../reference/stats19_schema.html">?stats19_schema</a></code> respectively). <code>stats19_schema</code> is used internally to automate the process of formatting the downloaded <code>.csv</code> files. Column names are formatted by the function <code><a href="../reference/format_column_names.html">format_column_names()</a></code>, as illustrated below:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="../reference/format_column_names.html">format_column_names</a></span>(stats19_variables<span class="op">$</span>variable[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co">#&gt; [1] "accident_index"    "police_force"      "accident_severity"</span></a></code></pre></div>
<p>Previous approaches to data formatting <code>STATS19</code> data involved hard-coding results. This more automated approach to data cleaning is more consistent and fail-safe. The three functions: <code><a href="../reference/format_accidents.html">format_accidents()</a></code>, <code><a href="../reference/format_vehicles.html">format_vehicles()</a></code> and <code><a href="../reference/format_casualties.html">format_casualties()</a></code> do the data formatting on the respective data frames, as illustrated below:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">crashes_<span class="dv">2017</span> =<span class="st"> </span><span class="kw"><a href="../reference/format_accidents.html">format_accidents</a></span>(crashes_<span class="dv">2017</span>_raw)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co"># vehicle data for 2017</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="kw"><a href="../reference/dl_stats19.html">dl_stats19</a></span>(<span class="dt">year =</span> <span class="dv">2017</span>, <span class="dt">type =</span> <span class="st">"vehicles"</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">#&gt; Files identified: dftRoadSafetyData_Vehicles_2017.zip</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt;    http://data.dft.gov.uk.s3.amazonaws.com/road-accidents-safety-data/dftRoadSafetyData_Vehicles_2017.zip</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">#&gt; Attempt downloading from:</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#&gt; Data saved at /tmp/RtmpglohrO/dftRoadSafetyData_Vehicles_2017/Veh.csv</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9">vehicles_<span class="dv">2017</span>_raw =<span class="st"> </span><span class="kw"><a href="../reference/read_vehicles.html">read_vehicles</a></span>(<span class="dt">year =</span> <span class="dv">2017</span>)</a>
<a class="sourceLine" id="cb14-10" data-line-number="10">vehicles_<span class="dv">2017</span> =<span class="st"> </span><span class="kw"><a href="../reference/format_vehicles.html">format_vehicles</a></span>(vehicles_<span class="dv">2017</span>_raw)</a>
<a class="sourceLine" id="cb14-11" data-line-number="11"></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="co"># casualties data for 2017</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="kw"><a href="../reference/dl_stats19.html">dl_stats19</a></span>(<span class="dt">year =</span> <span class="dv">2017</span>, <span class="dt">type =</span> <span class="st">"casualties"</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">#&gt; Files identified: dftRoadSafetyData_Casualties_2017.zip</span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="co">#&gt;    http://data.dft.gov.uk.s3.amazonaws.com/road-accidents-safety-data/dftRoadSafetyData_Casualties_2017.zip</span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="co">#&gt; Attempt downloading from:</span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17"><span class="co">#&gt; Data saved at /tmp/RtmpglohrO/dftRoadSafetyData_Casualties_2017/Cas.csv</span></a>
<a class="sourceLine" id="cb14-18" data-line-number="18">casualties_<span class="dv">2017</span> =<span class="st"> </span><span class="kw"><a href="../reference/read_casualties.html">read_casualties</a></span>(<span class="dt">year =</span> <span class="dv">2017</span>)</a></code></pre></div>
<p>The package automates this two-step <code>read_*</code> and <code>format_*</code> process by defaulting in all cases to <code>data_year = read_*(year, format = TRUE)</code>. <code>read_*</code> functions return, by default, formatted data. The two-step process may nevertheless be important for reference to the official nomenclature and values as provided by the DfT.</p>
<p>A summary of the outputs for each of the three tables is shown below.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">summarise_stats19 =<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">  <span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">row.names =</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(x),</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">    <span class="dt">name =</span> <span class="kw"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(x), <span class="dv">1</span>, <span class="dv">19</span>),</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">    <span class="dt">class =</span> <span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(x, class),</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">    <span class="dt">n_unique =</span> <span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(x, <span class="cf">function</span>(v) <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(v))),</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">    <span class="dt">first_label =</span> <span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(x, <span class="cf">function</span>(v) <span class="kw"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(v)[<span class="dv">1</span>], <span class="dv">1</span>, <span class="dv">9</span>)),</a>
<a class="sourceLine" id="cb15-7" data-line-number="7">    <span class="dt">second_label =</span> <span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(x, <span class="cf">function</span>(v) <span class="kw"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(v)[<span class="dv">2</span>], <span class="dv">1</span>, <span class="dv">9</span>))</a>
<a class="sourceLine" id="cb15-8" data-line-number="8">  )</a>
<a class="sourceLine" id="cb15-9" data-line-number="9">}</a></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw">summarise_stats19</span>(crashes_<span class="dv">2017</span>), </a>
<a class="sourceLine" id="cb16-2" data-line-number="2">             <span class="dt">caption =</span> <span class="st">"Summary of formatted crash data."</span>)</a></code></pre></div>
<table class="table">
<caption>Summary of formatted crash data.</caption>
<thead><tr class="header">
<th align="left">name</th>
<th align="left">class.accident_index</th>
<th align="left">class.location_easting_osgr</th>
<th align="left">class.location_northing_osgr</th>
<th align="left">class.longitude</th>
<th align="left">class.latitude</th>
<th align="left">class.police_force</th>
<th align="left">class.accident_severity</th>
<th align="left">class.number_of_vehicles</th>
<th align="left">class.number_of_casualties</th>
<th align="left">class.date</th>
<th align="left">class.day_of_week</th>
<th align="left">class.time</th>
<th align="left">class.local_authority_district</th>
<th align="left">class.local_authority_highway</th>
<th align="left">class.first_road_class</th>
<th align="left">class.first_road_number</th>
<th align="left">class.road_type</th>
<th align="left">class.speed_limit</th>
<th align="left">class.junction_detail</th>
<th align="left">class.junction_control</th>
<th align="left">class.second_road_class</th>
<th align="left">class.second_road_number</th>
<th align="left">class.pedestrian_crossing_human_control</th>
<th align="left">class.pedestrian_crossing_physical_facilities</th>
<th align="left">class.light_conditions</th>
<th align="left">class.weather_conditions</th>
<th align="left">class.road_surface_conditions</th>
<th align="left">class.special_conditions_at_site</th>
<th align="left">class.carriageway_hazards</th>
<th align="left">class.urban_or_rural_area</th>
<th align="left">class.did_police_officer_attend_scene_of_accident</th>
<th align="left">class.lsoa_of_accident_location</th>
<th align="right">n_unique</th>
<th align="left">first_label</th>
<th align="left">second_label</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">accident_index</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXct</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">129982</td>
<td align="left">201701000</td>
<td align="left">201701000</td>
</tr>
<tr class="even">
<td align="left">location_easting_os</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXt</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">89265</td>
<td align="left">532920</td>
<td align="left">526790</td>
</tr>
<tr class="odd">
<td align="left">location_northing_o</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXct</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">91209</td>
<td align="left">196330</td>
<td align="left">181970</td>
</tr>
<tr class="even">
<td align="left">longitude</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXt</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">124619</td>
<td align="left">-0.080107</td>
<td align="left">-0.173845</td>
</tr>
<tr class="odd">
<td align="left">latitude</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXct</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">123292</td>
<td align="left">51.650061</td>
<td align="left">51.522425</td>
</tr>
<tr class="even">
<td align="left">police_force</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXt</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">51</td>
<td align="left">Metropoli</td>
<td align="left">City of L</td>
</tr>
<tr class="odd">
<td align="left">accident_severity</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXct</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">3</td>
<td align="left">Fatal</td>
<td align="left">Slight</td>
</tr>
<tr class="even">
<td align="left">number_of_vehicles</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXt</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">15</td>
<td align="left">2</td>
<td align="left">3</td>
</tr>
<tr class="odd">
<td align="left">number_of_casualtie</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXct</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">20</td>
<td align="left">3</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">date</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXt</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">365</td>
<td align="left">2017-08-0</td>
<td align="left">2017-01-0</td>
</tr>
<tr class="odd">
<td align="left">day_of_week</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXct</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">7</td>
<td align="left">Saturday</td>
<td align="left">Sunday</td>
</tr>
<tr class="even">
<td align="left">time</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXt</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">1439</td>
<td align="left">03:12</td>
<td align="left">01:30</td>
</tr>
<tr class="odd">
<td align="left">local_authority_dis</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXct</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">380</td>
<td align="left">Enfield</td>
<td align="left">Westminst</td>
</tr>
<tr class="even">
<td align="left">local_authority_hig</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXt</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">207</td>
<td align="left">Enfield</td>
<td align="left">Westminst</td>
</tr>
<tr class="odd">
<td align="left">first_road_class</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXct</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">6</td>
<td align="left">A</td>
<td align="left">Unclassif</td>
</tr>
<tr class="even">
<td align="left">first_road_number</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXt</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">3763</td>
<td align="left">105</td>
<td align="left">5</td>
</tr>
<tr class="odd">
<td align="left">road_type</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXct</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">6</td>
<td align="left">Single ca</td>
<td align="left">Roundabou</td>
</tr>
<tr class="even">
<td align="left">speed_limit</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXt</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">6</td>
<td align="left">30</td>
<td align="left">20</td>
</tr>
<tr class="odd">
<td align="left">junction_detail</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXct</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">10</td>
<td align="left">Not at ju</td>
<td align="left">T or stag</td>
</tr>
<tr class="even">
<td align="left">junction_control</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXt</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">5</td>
<td align="left">Data miss</td>
<td align="left">Give way</td>
</tr>
<tr class="odd">
<td align="left">second_road_class</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXct</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">7</td>
<td align="left">NA</td>
<td align="left">Unclassif</td>
</tr>
<tr class="even">
<td align="left">second_road_number</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXt</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">3281</td>
<td align="left">0</td>
<td align="left">154</td>
</tr>
<tr class="odd">
<td align="left">pedestrian_crossing</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXct</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">4</td>
<td align="left">None with</td>
<td align="left">Control b</td>
</tr>
<tr class="even">
<td align="left">pedestrian_crossing</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXt</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">7</td>
<td align="left">No physic</td>
<td align="left">Pelican,</td>
</tr>
<tr class="odd">
<td align="left">light_conditions</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXct</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">6</td>
<td align="left">Darkness</td>
<td align="left">Darkness</td>
</tr>
<tr class="even">
<td align="left">weather_conditions</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXt</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">10</td>
<td align="left">Fine no h</td>
<td align="left">Raining n</td>
</tr>
<tr class="odd">
<td align="left">road_surface_condit</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXct</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">6</td>
<td align="left">Dry</td>
<td align="left">Wet or da</td>
</tr>
<tr class="even">
<td align="left">special_conditions_</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXt</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">9</td>
<td align="left">None</td>
<td align="left">Roadworks</td>
</tr>
<tr class="odd">
<td align="left">carriageway_hazards</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXct</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">7</td>
<td align="left">None</td>
<td align="left">Data miss</td>
</tr>
<tr class="even">
<td align="left">urban_or_rural_area</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXt</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">3</td>
<td align="left">Urban</td>
<td align="left">Rural</td>
</tr>
<tr class="odd">
<td align="left">did_police_officer_</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXct</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">3</td>
<td align="left">1</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">lsoa_of_accident_lo</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">numeric</td>
<td align="left">numeric</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">integer</td>
<td align="left">POSIXt</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">integer</td>
<td align="left">character</td>
<td align="right">28286</td>
<td align="left">E01001450</td>
<td align="left">E01004702</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw">summarise_stats19</span>(vehicles_<span class="dv">2017</span>), </a>
<a class="sourceLine" id="cb17-2" data-line-number="2">             <span class="dt">caption =</span> <span class="st">"Summary of formatted vehicles data."</span>)</a></code></pre></div>
<table class="table">
<caption>Summary of formatted vehicles data.</caption>
<thead><tr class="header">
<th align="left">name</th>
<th align="left">class</th>
<th align="right">n_unique</th>
<th align="left">first_label</th>
<th align="left">second_label</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">accident_index</td>
<td align="left">character</td>
<td align="right">129982</td>
<td align="left">201701000</td>
<td align="left">201701000</td>
</tr>
<tr class="even">
<td align="left">vehicle_reference</td>
<td align="left">integer</td>
<td align="right">24</td>
<td align="left">1</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">vehicle_type</td>
<td align="left">character</td>
<td align="right">1</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">towing_and_articula</td>
<td align="left">character</td>
<td align="right">1</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">vehicle_manoeuvre</td>
<td align="left">character</td>
<td align="right">1</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">vehicle_location_re</td>
<td align="left">integer</td>
<td align="right">11</td>
<td align="left">0</td>
<td align="left">6</td>
</tr>
<tr class="odd">
<td align="left">junction_location</td>
<td align="left">character</td>
<td align="right">1</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">skidding_and_overtu</td>
<td align="left">character</td>
<td align="right">1</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">hit_object_in_carri</td>
<td align="left">integer</td>
<td align="right">13</td>
<td align="left">0</td>
<td align="left">9</td>
</tr>
<tr class="even">
<td align="left">vehicle_leaving_car</td>
<td align="left">integer</td>
<td align="right">10</td>
<td align="left">0</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">hit_object_off_carr</td>
<td align="left">integer</td>
<td align="right">13</td>
<td align="left">0</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">first_point_of_impa</td>
<td align="left">character</td>
<td align="right">1</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">was_vehicle_left_ha</td>
<td align="left">character</td>
<td align="right">1</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">journey_purpose_of_</td>
<td align="left">character</td>
<td align="right">1</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">sex_of_driver</td>
<td align="left">character</td>
<td align="right">1</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">age_of_driver</td>
<td align="left">integer</td>
<td align="right">100</td>
<td align="left">24</td>
<td align="left">19</td>
</tr>
<tr class="odd">
<td align="left">age_band_of_driver</td>
<td align="left">integer</td>
<td align="right">12</td>
<td align="left">5</td>
<td align="left">4</td>
</tr>
<tr class="even">
<td align="left">engine_capacity_cc</td>
<td align="left">integer</td>
<td align="right">1103</td>
<td align="left">1997</td>
<td align="left">-1</td>
</tr>
<tr class="odd">
<td align="left">propulsion_code</td>
<td align="left">character</td>
<td align="right">1</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">age_of_vehicle</td>
<td align="left">integer</td>
<td align="right">71</td>
<td align="left">1</td>
<td align="left">-1</td>
</tr>
<tr class="odd">
<td align="left">driver_imd_decile</td>
<td align="left">character</td>
<td align="right">1</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">driver_home_area_ty</td>
<td align="left">integer</td>
<td align="right">4</td>
<td align="left">-1</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">vehicle_imd_decile</td>
<td align="left">integer</td>
<td align="right">11</td>
<td align="left">-1</td>
<td align="left">9</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw">summarise_stats19</span>(casualties_<span class="dv">2017</span>), </a>
<a class="sourceLine" id="cb18-2" data-line-number="2">             <span class="dt">caption =</span> <span class="st">"Summary of formatted casualty data."</span>)</a></code></pre></div>
<table class="table">
<caption>Summary of formatted casualty data.</caption>
<thead><tr class="header">
<th align="left">name</th>
<th align="left">class</th>
<th align="right">n_unique</th>
<th align="left">first_label</th>
<th align="left">second_label</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">accident_index</td>
<td align="left">character</td>
<td align="right">129982</td>
<td align="left">201701000</td>
<td align="left">201701000</td>
</tr>
<tr class="even">
<td align="left">vehicle_reference</td>
<td align="left">integer</td>
<td align="right">15</td>
<td align="left">1</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">casualty_reference</td>
<td align="left">integer</td>
<td align="right">43</td>
<td align="left">1</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">casualty_class</td>
<td align="left">character</td>
<td align="right">3</td>
<td align="left">Passenger</td>
<td align="left">Driver or</td>
</tr>
<tr class="odd">
<td align="left">sex_of_casualty</td>
<td align="left">character</td>
<td align="right">3</td>
<td align="left">Female</td>
<td align="left">Male</td>
</tr>
<tr class="even">
<td align="left">age_of_casualty</td>
<td align="left">integer</td>
<td align="right">102</td>
<td align="left">18</td>
<td align="left">19</td>
</tr>
<tr class="odd">
<td align="left">age_band_of_casualt</td>
<td align="left">character</td>
<td align="right">12</td>
<td align="left">16 - 20</td>
<td align="left">26 - 35</td>
</tr>
<tr class="even">
<td align="left">casualty_severity</td>
<td align="left">character</td>
<td align="right">3</td>
<td align="left">Slight</td>
<td align="left">Serious</td>
</tr>
<tr class="odd">
<td align="left">pedestrian_location</td>
<td align="left">character</td>
<td align="right">11</td>
<td align="left">Not a Ped</td>
<td align="left">Crossing</td>
</tr>
<tr class="even">
<td align="left">pedestrian_movement</td>
<td align="left">character</td>
<td align="right">10</td>
<td align="left">Not a Ped</td>
<td align="left">Crossing</td>
</tr>
<tr class="odd">
<td align="left">car_passenger</td>
<td align="left">character</td>
<td align="right">4</td>
<td align="left">Front sea</td>
<td align="left">Not car p</td>
</tr>
<tr class="even">
<td align="left">bus_or_coach_passen</td>
<td align="left">character</td>
<td align="right">6</td>
<td align="left">Not a bus</td>
<td align="left">Standing</td>
</tr>
<tr class="odd">
<td align="left">pedestrian_road_mai</td>
<td align="left">character</td>
<td align="right">4</td>
<td align="left">No / Not</td>
<td align="left">Not Known</td>
</tr>
<tr class="even">
<td align="left">casualty_type</td>
<td align="left">character</td>
<td align="right">22</td>
<td align="left">Car occup</td>
<td align="left">Motorcycl</td>
</tr>
<tr class="odd">
<td align="left">casualty_home_area_</td>
<td align="left">character</td>
<td align="right">4</td>
<td align="left">Urban are</td>
<td align="left">Data miss</td>
</tr>
<tr class="even">
<td align="left">casualty_imd_decile</td>
<td align="left">character</td>
<td align="right">11</td>
<td align="left">More depr</td>
<td align="left">Data miss</td>
</tr>
</tbody>
</table>
<p>For testing and other purposes, a sample from the accidents table is provided in the package. A few columns from the two-row sample is shown below:</p>
<table class="table">
<thead><tr class="header">
<th align="right">Accident_Severity</th>
<th align="right">Speed_limit</th>
<th align="right">Pedestrian_Crossing-Human_Control</th>
<th align="right">Light_Conditions</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2</td>
<td align="right">30</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">30</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">60</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<div id="casualties-data" class="section level2">
<h2 class="hasAnchor">
<a href="#casualties-data" class="anchor"></a>Casualties data</h2>
<p>As with <code>crashes_2017</code>, casualty data for 2017 can be downloaded, read-in and formatted as follows:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw"><a href="../reference/dl_stats19.html">dl_stats19</a></span>(<span class="dt">year =</span> <span class="dv">2017</span>, <span class="dt">type =</span> <span class="st">"casualties"</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="co">#&gt; Files identified: dftRoadSafetyData_Casualties_2017.zip</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="co">#&gt;    http://data.dft.gov.uk.s3.amazonaws.com/road-accidents-safety-data/dftRoadSafetyData_Casualties_2017.zip</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="co">#&gt; Data already exists in data_dir, not downloading</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="co">#&gt; Data saved at /tmp/RtmpglohrO/dftRoadSafetyData_Casualties_2017/Cas.csv</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6">casualties_<span class="dv">2017</span> =<span class="st"> </span><span class="kw"><a href="../reference/read_casualties.html">read_casualties</a></span>(<span class="dt">year =</span> <span class="dv">2017</span>)</a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(casualties_<span class="dv">2017</span>)</a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="co">#&gt; [1] 170993</span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(casualties_<span class="dv">2017</span>)</a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="co">#&gt; [1] 16</span></a></code></pre></div>
<p>The results show that there were 170,993 casualties reported by the police in the STATS19 dataset in 2017, and 16 columns (variables). Values for a sample of these columns are shown below:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">casualties_<span class="dv">2017</span>[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">14</span>)]</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="co">#&gt; # A tibble: 170,993 x 4</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="co">#&gt;    casualty_class  sex_of_casualty age_of_casualty casualty_type                </span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="co">#&gt;    &lt;chr&gt;           &lt;chr&gt;                     &lt;int&gt; &lt;chr&gt;                        </span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="co">#&gt;  1 Passenger       Female                       18 Car occupant                 </span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="co">#&gt;  2 Driver or rider Male                         19 Motorcycle 50cc and under ri…</span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="co">#&gt;  3 Passenger       Male                         18 Motorcycle 50cc and under ri…</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="co">#&gt;  4 Passenger       Female                       33 Car occupant                 </span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="co">#&gt;  5 Driver or rider Female                       31 Car occupant                 </span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="co">#&gt;  6 Passenger       Male                          3 Car occupant                 </span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="co">#&gt;  7 Pedestrian      Male                         45 Pedestrian                   </span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="co">#&gt;  8 Driver or rider Male                         14 Motorcycle 125cc and under r…</span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13"><span class="co">#&gt;  9 Driver or rider Female                       58 Car occupant                 </span></a>
<a class="sourceLine" id="cb20-14" data-line-number="14"><span class="co">#&gt; 10 Driver or rider Male                         27 Car occupant                 </span></a>
<a class="sourceLine" id="cb20-15" data-line-number="15"><span class="co">#&gt; # … with 170,983 more rows</span></a></code></pre></div>
<p>The full list of column names in the <code>casualties</code> dataset is:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(casualties_<span class="dv">2017</span>)</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="co">#&gt;  [1] "accident_index"                     "vehicle_reference"                 </span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="co">#&gt;  [3] "casualty_reference"                 "casualty_class"                    </span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="co">#&gt;  [5] "sex_of_casualty"                    "age_of_casualty"                   </span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="co">#&gt;  [7] "age_band_of_casualty"               "casualty_severity"                 </span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="co">#&gt;  [9] "pedestrian_location"                "pedestrian_movement"               </span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="co">#&gt; [11] "car_passenger"                      "bus_or_coach_passenger"            </span></a>
<a class="sourceLine" id="cb21-8" data-line-number="8"><span class="co">#&gt; [13] "pedestrian_road_maintenance_worker" "casualty_type"                     </span></a>
<a class="sourceLine" id="cb21-9" data-line-number="9"><span class="co">#&gt; [15] "casualty_home_area_type"            "casualty_imd_decile"</span></a></code></pre></div>
</div>
<div id="vehicles-data" class="section level2">
<h2 class="hasAnchor">
<a href="#vehicles-data" class="anchor"></a>Vehicles data</h2>
<p>Data for vehicles involved in crashes in 2017 can be downloaded, read-in and formatted as follows:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw"><a href="../reference/dl_stats19.html">dl_stats19</a></span>(<span class="dt">year =</span> <span class="dv">2017</span>, <span class="dt">type =</span> <span class="st">"vehicles"</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="co">#&gt; Files identified: dftRoadSafetyData_Vehicles_2017.zip</span></a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="co">#&gt;    http://data.dft.gov.uk.s3.amazonaws.com/road-accidents-safety-data/dftRoadSafetyData_Vehicles_2017.zip</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="co">#&gt; Data already exists in data_dir, not downloading</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="co">#&gt; Data saved at /tmp/RtmpglohrO/dftRoadSafetyData_Vehicles_2017/Veh.csv</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6">vehicles_<span class="dv">2017</span> =<span class="st"> </span><span class="kw"><a href="../reference/read_vehicles.html">read_vehicles</a></span>(<span class="dt">year =</span> <span class="dv">2017</span>)</a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(vehicles_<span class="dv">2017</span>)</a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="co">#&gt; [1] 238926</span></a>
<a class="sourceLine" id="cb22-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(vehicles_<span class="dv">2017</span>)</a>
<a class="sourceLine" id="cb22-10" data-line-number="10"><span class="co">#&gt; [1] 23</span></a></code></pre></div>
<p>The results show that there were 238,926 vehicles involved in crashes reported by the police in the STATS19 dataset in 2017, with 23 columns (variables). Values for a sample of these columns are shown below:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">vehicles_<span class="dv">2017</span>[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">3</span>, <span class="dv">14</span><span class="op">:</span><span class="dv">16</span>)]</a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="co">#&gt; # A tibble: 238,926 x 4</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="co">#&gt;    vehicle_type             journey_purpose_of_driv… sex_of_driver age_of_driver</span></a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="co">#&gt;    &lt;chr&gt;                    &lt;chr&gt;                    &lt;chr&gt;                 &lt;int&gt;</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="co">#&gt;  1 Car                      Not known                Male                     24</span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6"><span class="co">#&gt;  2 Motorcycle 50cc and und… Not known                Male                     19</span></a>
<a class="sourceLine" id="cb23-7" data-line-number="7"><span class="co">#&gt;  3 Car                      Not known                Male                     33</span></a>
<a class="sourceLine" id="cb23-8" data-line-number="8"><span class="co">#&gt;  4 Car                      Not known                Male                     40</span></a>
<a class="sourceLine" id="cb23-9" data-line-number="9"><span class="co">#&gt;  5 Car                      Not known                Not known                -1</span></a>
<a class="sourceLine" id="cb23-10" data-line-number="10"><span class="co">#&gt;  6 Car                      Not known                Male                     35</span></a>
<a class="sourceLine" id="cb23-11" data-line-number="11"><span class="co">#&gt;  7 Car                      Not known                Female                   31</span></a>
<a class="sourceLine" id="cb23-12" data-line-number="12"><span class="co">#&gt;  8 Car                      Not known                Female                   37</span></a>
<a class="sourceLine" id="cb23-13" data-line-number="13"><span class="co">#&gt;  9 Car                      Not known                Female                   29</span></a>
<a class="sourceLine" id="cb23-14" data-line-number="14"><span class="co">#&gt; 10 Car                      Not known                Male                     78</span></a>
<a class="sourceLine" id="cb23-15" data-line-number="15"><span class="co">#&gt; # … with 238,916 more rows</span></a></code></pre></div>
<p>The full list of column names in the <code>vehicles</code> dataset is:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(vehicles_<span class="dv">2017</span>)</a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="co">#&gt;  [1] "accident_index"                   "vehicle_reference"               </span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="co">#&gt;  [3] "vehicle_type"                     "towing_and_articulation"         </span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="co">#&gt;  [5] "vehicle_manoeuvre"                "vehicle_location_restricted_lane"</span></a>
<a class="sourceLine" id="cb24-5" data-line-number="5"><span class="co">#&gt;  [7] "junction_location"                "skidding_and_overturning"        </span></a>
<a class="sourceLine" id="cb24-6" data-line-number="6"><span class="co">#&gt;  [9] "hit_object_in_carriageway"        "vehicle_leaving_carriageway"     </span></a>
<a class="sourceLine" id="cb24-7" data-line-number="7"><span class="co">#&gt; [11] "hit_object_off_carriageway"       "first_point_of_impact"           </span></a>
<a class="sourceLine" id="cb24-8" data-line-number="8"><span class="co">#&gt; [13] "was_vehicle_left_hand_drive"      "journey_purpose_of_driver"       </span></a>
<a class="sourceLine" id="cb24-9" data-line-number="9"><span class="co">#&gt; [15] "sex_of_driver"                    "age_of_driver"                   </span></a>
<a class="sourceLine" id="cb24-10" data-line-number="10"><span class="co">#&gt; [17] "age_band_of_driver"               "engine_capacity_cc"              </span></a>
<a class="sourceLine" id="cb24-11" data-line-number="11"><span class="co">#&gt; [19] "propulsion_code"                  "age_of_vehicle"                  </span></a>
<a class="sourceLine" id="cb24-12" data-line-number="12"><span class="co">#&gt; [21] "driver_imd_decile"                "driver_home_area_type"           </span></a>
<a class="sourceLine" id="cb24-13" data-line-number="13"><span class="co">#&gt; [23] "vehicle_imd_decile"</span></a></code></pre></div>
<!-- More data can be read-in as follows: -->
</div>
<div id="creating-geographic-crash-data" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-geographic-crash-data" class="anchor"></a>Creating geographic crash data</h2>
<p>An important feature of STATS19 data is that the “accidents” table contains geographic coordinates. These are provided at ~10m resolution in the UK’s official coordinate reference system (the Ordnance Survey National Grid, EPSG code 27700). <strong>stats19</strong> converts the non-geographic tables created by <code><a href="../reference/format_accidents.html">format_accidents()</a></code> into the geographic data form of the <a href="https://cran.r-project.org/package=sf"><code>sf</code> package</a> with the function <code><a href="../reference/format_sf.html">format_sf()</a></code> as follows:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">crashes_sf =<span class="st"> </span><span class="kw"><a href="../reference/format_sf.html">format_sf</a></span>(crashes_<span class="dv">2017</span>)</a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="co">#&gt; 19 rows removed with no coordinates</span></a></code></pre></div>
<p>The note arises because <code>NA</code> values are not permitted in <code>sf</code> coordinates, and so rows containing no coordinates are automatically removed. Having the data in a standard geographic form allows various geographic operations to be performed on it. Spatial operations, such as spatial subsetting and spatial aggregation, can be performed, to show the relationship between STATS19 data and other geographic objects, such as roads, schools and administrative zones.</p>
<p>An example of an administrative zone dataset of relevance to STATS19 data is the boundaries of police forces in England, which is provided in the packaged dataset <code>police_boundaries</code>. The following code chunk demonstrates the kind of spatial operations that can be performed on geographic STATS19 data, by counting and plotting the number of fatalities per police force:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(sf)</a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="co">#&gt; Linking to GEOS 3.7.1, GDAL 2.2.2, PROJ 4.9.2</span></a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="co">#&gt; </span><span class="al">WARNING</span><span class="co">: different compile-time and runtime versions for GEOS found:</span></a>
<a class="sourceLine" id="cb26-4" data-line-number="4"><span class="co">#&gt; Linked against: 3.7.1-CAPI-1.11.1 27a5e771 compiled against: 3.5.1-CAPI-1.9.1</span></a>
<a class="sourceLine" id="cb26-5" data-line-number="5"><span class="co">#&gt; It is probably a good idea to reinstall sf, and maybe rgeos and rgdal too</span></a>
<a class="sourceLine" id="cb26-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb26-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb26-8" data-line-number="8"><span class="co">#&gt; Attaching package: 'dplyr'</span></a>
<a class="sourceLine" id="cb26-9" data-line-number="9"><span class="co">#&gt; The following objects are masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb26-10" data-line-number="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb26-11" data-line-number="11"><span class="co">#&gt;     filter, lag</span></a>
<a class="sourceLine" id="cb26-12" data-line-number="12"><span class="co">#&gt; The following objects are masked from 'package:base':</span></a>
<a class="sourceLine" id="cb26-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb26-14" data-line-number="14"><span class="co">#&gt;     intersect, setdiff, setequal, union</span></a>
<a class="sourceLine" id="cb26-15" data-line-number="15">crashes_sf <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-16" data-line-number="16"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(accident_severity <span class="op">==</span><span class="st"> "Fatal"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-17" data-line-number="17"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="dt">n_fatalities =</span> accident_index) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-18" data-line-number="18"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/sf/man/aggregate.sf.html">aggregate</a></span>(<span class="dt">by =</span> police_boundaries, <span class="dt">FUN =</span> length) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-19" data-line-number="19"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/sf/man/plot.html">plot</a></span>()</a></code></pre></div>
<p><img src="stats19_files/figure-html/nfatalities-1.png" width="100%"></p>
<p>Of course, one should not draw conclusions from such analyses without care. In this case, denominators are needed to infer anything about road safety in any of the police regions. After suitable denominators have been included, performance metrics such as ‘health risk’ (fatalities per 100,000 people), ‘traffic risk’ (fatalities per billion km, f/bkm) and ‘exposure risk’ (fatalities per million hours, f/mh) can be calculated <span class="citation">(Feleke et al. 2018; Elvik et al. 2009)</span>.</p>
<p>The following code chunk, for example, returns all crashes within the jurisdiction of <a href="https://en.wikipedia.org/wiki/West_Yorkshire_Police">West Yorkshire Police</a>:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">west_yorkshire =</a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="st">  </span>police_boundaries[police_boundaries<span class="op">$</span>pfa16nm <span class="op">==</span><span class="st"> "West Yorkshire"</span>, ]</a></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">crashes_wy =<span class="st"> </span>crashes_sf[west_yorkshire, ]</a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(crashes_sf)</a>
<a class="sourceLine" id="cb28-3" data-line-number="3"><span class="co">#&gt; [1] 129963</span></a>
<a class="sourceLine" id="cb28-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(crashes_wy)</a>
<a class="sourceLine" id="cb28-5" data-line-number="5"><span class="co">#&gt; [1] 4371</span></a></code></pre></div>
<p>This subsetting has selected the 4,371 crashes which occurred in West Yorkshire.</p>
</div>
<div id="joining-tables" class="section level2">
<h2 class="hasAnchor">
<a href="#joining-tables" class="anchor"></a>Joining tables</h2>
<p>The three main tables we have just read-in can be joined by shared key variables. This is demonstrated in the code chunk below, which subsets all casualties that took place in West Yorkshire, and counts the number of casualties by severity for each crash:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyr)</a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb29-3" data-line-number="3">sel =<span class="st"> </span>casualties_<span class="dv">2017</span><span class="op">$</span>accident_index <span class="op">%in%</span><span class="st"> </span>crashes_wy<span class="op">$</span>accident_index</a>
<a class="sourceLine" id="cb29-4" data-line-number="4">casualties_wy =<span class="st"> </span>casualties_<span class="dv">2017</span>[sel, ]</a>
<a class="sourceLine" id="cb29-5" data-line-number="5">cas_types =<span class="st"> </span>casualties_wy <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(accident_index, casualty_type) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(accident_index) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(</a>
<a class="sourceLine" id="cb29-9" data-line-number="9">    <span class="dt">Total =</span> <span class="kw"><a href="https://dplyr.tidyverse.org/reference/n.html">n</a></span>(),</a>
<a class="sourceLine" id="cb29-10" data-line-number="10">    <span class="dt">walking =</span> <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(casualty_type <span class="op">==</span><span class="st"> "Pedestrian"</span>),</a>
<a class="sourceLine" id="cb29-11" data-line-number="11">    <span class="dt">cycling =</span> <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(casualty_type <span class="op">==</span><span class="st"> "Cyclist"</span>),</a>
<a class="sourceLine" id="cb29-12" data-line-number="12">    <span class="dt">passenger =</span> <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(casualty_type <span class="op">==</span><span class="st"> "Car occupant"</span>)</a>
<a class="sourceLine" id="cb29-13" data-line-number="13">    ) </a>
<a class="sourceLine" id="cb29-14" data-line-number="14">cj =<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(crashes_wy, cas_types)</a></code></pre></div>
<p>What just happened? We found the subset of casualties that took place in West Yorkshire with reference to the <code>accident_index</code> variable. Then we used the <strong>dplyr</strong> function <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code>, to find the number of people who were in a car, cycling, and walking when they were injured. This new casualty dataset is joined onto the <code>crashes_wy</code> dataset. The result is a spatial (<code>sf</code>) data frame of crashes in West Yorkshire, with columns counting how many road users of different types were hurt. The joined data has additional variables:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">base<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(cj), <span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(crashes_wy))</a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="co">#&gt; [1] "Total"     "walking"   "cycling"   "passenger"</span></a></code></pre></div>
<p>As a simple spatial plot, we can map all the crashes that have happened in West Yorkshire in 2017, with the colour related to the total number of people hurt in each crash. Placing this plot next to a map of West Yorkshire provides context:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/pkg/sf/man/plot.html">plot</a></span>(</a>
<a class="sourceLine" id="cb31-2" data-line-number="2">  cj[cj<span class="op">$</span>cycling <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="st">"speed_limit"</span>, ],</a>
<a class="sourceLine" id="cb31-3" data-line-number="3">  <span class="dt">cex =</span> cj<span class="op">$</span>Total[cj<span class="op">$</span>cycling <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>] <span class="op">/</span><span class="st"> </span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb31-4" data-line-number="4">  <span class="dt">main =</span> <span class="st">"Speed limit (cycling)"</span></a>
<a class="sourceLine" id="cb31-5" data-line-number="5">  )</a>
<a class="sourceLine" id="cb31-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/pkg/sf/man/plot.html">plot</a></span>(</a>
<a class="sourceLine" id="cb31-7" data-line-number="7">  cj[cj<span class="op">$</span>passenger <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="st">"speed_limit"</span>, ],</a>
<a class="sourceLine" id="cb31-8" data-line-number="8">  <span class="dt">cex =</span> cj<span class="op">$</span>Total[cj<span class="op">$</span>passenger <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>] <span class="op">/</span><span class="st"> </span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb31-9" data-line-number="9">  <span class="dt">main =</span> <span class="st">"Speed limit (passenger)"</span></a>
<a class="sourceLine" id="cb31-10" data-line-number="10">  )</a></code></pre></div>
<p><img src="stats19_files/figure-html/unnamed-chunk-7-1.png" width="90%"><img src="stats19_files/figure-html/unnamed-chunk-7-2.png" width="90%"></p>
<p>The spatial distribution of crashes in West Yorkshire clearly relates to the region’s geography. Car crashes tend to happen on fast roads, including busy Motorway roads, displayed in yellow above. Cycling is as an urban activity, and the most bike crashes can be found in near Leeds city centre, which has a comparatively high level of cycling (compared with the low baseline of 3%). This can be seen by comparing the previous map with an overview of the area, from an academic paper on the social, spatial and temporal distribution of bike crashes <span class="citation">(Lovelace, Roberts, and Kellar 2016)</span>:</p>
<p><img src="wy-overview.jpg" width="100%"></p>
<p>In addition to the <code>Total</code> number of people hurt/killed, <code>cj</code> contains a column for each type of casualty (cyclist, car occupant, etc.), and a number corresponding to the number of each type hurt in each crash. It also contains the <code>geometry</code> column from <code>crashes_sf</code>. In other words, joins allow the casualties and vehicles tables to be geo-referenced. We can then explore the spatial distribution of different casualty types. The following figure, for example, shows the spatial distribution of pedestrians and car passengers hurt in car crashes across West Yorkshire in 2017:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb32-2" data-line-number="2">crashes_types =<span class="st"> </span>cj <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(accident_severity <span class="op">!=</span><span class="st"> "Slight"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">type =</span> <span class="kw"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span>(</a>
<a class="sourceLine" id="cb32-5" data-line-number="5">    walking <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> "Walking"</span>,</a>
<a class="sourceLine" id="cb32-6" data-line-number="6">    cycling <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> "Cycling"</span>,</a>
<a class="sourceLine" id="cb32-7" data-line-number="7">    passenger <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> "Passenger"</span>,</a>
<a class="sourceLine" id="cb32-8" data-line-number="8">    <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> "Other"</span></a>
<a class="sourceLine" id="cb32-9" data-line-number="9">  ))</a>
<a class="sourceLine" id="cb32-10" data-line-number="10"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(crashes_types, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">size =</span> Total, <span class="dt">colour =</span> speed_limit)) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span>(<span class="dt">show.legend =</span> <span class="st">"point"</span>, <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-12" data-line-number="12"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span>(type), <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span>(accident_severity)) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-13" data-line-number="13"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html">scale_size</a></span>(</a>
<a class="sourceLine" id="cb32-14" data-line-number="14">    <span class="dt">breaks =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb32-15" data-line-number="15">    <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="st">"3+"</span>, <span class="dv">12</span>)</a>
<a class="sourceLine" id="cb32-16" data-line-number="16">    ) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-17" data-line-number="17"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_color_gradientn</a></span>(<span class="dt">colours =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"blue"</span>, <span class="st">"yellow"</span>, <span class="st">"red"</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-18" data-line-number="18"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">axis.text =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(), <span class="dt">axis.ticks =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>())</a></code></pre></div>
<div class="figure">
<img src="stats19_files/figure-html/sfplot-1.png" alt="Spatial distribution of serious and fatal crashes in West Yorkshire, for cycling, walking, being a car passenger and other modes of travel. Colour is related to the speed limit where the crash happened (red is faster) and size is proportional to the total number of people hurt in each crash (legend not shown)." width="100%"><p class="caption">
Spatial distribution of serious and fatal crashes in West Yorkshire, for cycling, walking, being a car passenger and other modes of travel. Colour is related to the speed limit where the crash happened (red is faster) and size is proportional to the total number of people hurt in each crash (legend not shown).
</p>
</div>
<p>It is clear that different types of road users tend to get hurt in different places. Car occupant casualties (labelled ‘passengers’ in the map above), for example, are comparatively common on the outskirts of cities such as Leeds, where speed limits tend to be higher and where there are comparatively higher volumes of motor traffic. Casualties to people on foot tend to happen in the city centres. That is not to say that cities centres are more dangerous per unit distance (typically casualties per billion kilometres, bkm, is the unit used) walked: there is more walking in city centres (you need a denominator to estimate risk).</p>
<p>To drill down further, we can find the spatial distribution of all pedestrian casualties, broken-down by seriousness of casualty, and light conditions. This can be done with <strong>tidyvers</strong> functions follows:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(cj<span class="op">$</span>light_conditions)</a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb33-3" data-line-number="3"><span class="co">#&gt; Darkness - lighting unknown       Darkness - lights lit </span></a>
<a class="sourceLine" id="cb33-4" data-line-number="4"><span class="co">#&gt;                         864                        1051 </span></a>
<a class="sourceLine" id="cb33-5" data-line-number="5"><span class="co">#&gt;     Darkness - lights unlit      Darkness - no lighting </span></a>
<a class="sourceLine" id="cb33-6" data-line-number="6"><span class="co">#&gt;                          11                          88 </span></a>
<a class="sourceLine" id="cb33-7" data-line-number="7"><span class="co">#&gt;                    Daylight </span></a>
<a class="sourceLine" id="cb33-8" data-line-number="8"><span class="co">#&gt;                        2357</span></a>
<a class="sourceLine" id="cb33-9" data-line-number="9">cj <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(walking <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">light =</span> <span class="kw"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span>(</a>
<a class="sourceLine" id="cb33-12" data-line-number="12">    light_conditions <span class="op">==</span><span class="st"> "Daylight"</span> <span class="op">~</span><span class="st"> "Daylight"</span>,</a>
<a class="sourceLine" id="cb33-13" data-line-number="13">    light_conditions <span class="op">==</span><span class="st"> "Darkness - lights lit"</span> <span class="op">~</span><span class="st"> "Lit"</span>,</a>
<a class="sourceLine" id="cb33-14" data-line-number="14">    <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> "Other/Unlit"</span></a>
<a class="sourceLine" id="cb33-15" data-line-number="15">  )) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-16" data-line-number="16"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">colour =</span> speed_limit)) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-17" data-line-number="17"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb33-18" data-line-number="18"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span>(light), <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span>(accident_severity)) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-19" data-line-number="19"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_color_continuous</a></span>(<span class="dt">low =</span> <span class="st">"blue"</span>, <span class="dt">high =</span> <span class="st">"red"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-20" data-line-number="20"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">axis.text =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(), <span class="dt">axis.ticks =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>())</a></code></pre></div>
<p><img src="stats19_files/figure-html/ggplot-ped-severity-1.png" width="100%"></p>
<!-- These figures show the issue of pedestrian casualties in Leeds and Bradford city centres, which both have busy roads going through or around popular shopping and other destinations. -->
</div>
<div id="time-series-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#time-series-analysis" class="anchor"></a>Time series analysis</h2>
<p>We can also explore seasonal and daily trends in crashes by aggregating crashes by day of the year:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">crashes_dates =<span class="st"> </span>cj <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb34-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/sf/man/st_geometry.html">st_set_geometry</a></span>(<span class="ot">NULL</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb34-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(date) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb34-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(</a>
<a class="sourceLine" id="cb34-5" data-line-number="5">    <span class="dt">walking =</span> <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(walking),</a>
<a class="sourceLine" id="cb34-6" data-line-number="6">    <span class="dt">cycling =</span> <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(cycling),</a>
<a class="sourceLine" id="cb34-7" data-line-number="7">    <span class="dt">passenger =</span> <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(passenger)</a>
<a class="sourceLine" id="cb34-8" data-line-number="8">    ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb34-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span>(mode, casualties, <span class="op">-</span>date)</a>
<a class="sourceLine" id="cb34-10" data-line-number="10"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(crashes_dates, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(date, casualties)) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">colour =</span> mode), <span class="dt">method =</span> <span class="st">"loess"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-12" data-line-number="12"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="st">"Casualties per day"</span>)</a></code></pre></div>
<p><img src="stats19_files/figure-html/crash-date-plot-1.png" width="100%"></p>
<p>Different types of crashes also tend to happen at different times of day. This is illustrated in the plot below, which shows the times of day when people who were travelling by different modes were most commonly injured.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(stringr)</a>
<a class="sourceLine" id="cb35-2" data-line-number="2"></a>
<a class="sourceLine" id="cb35-3" data-line-number="3">crash_times =<span class="st"> </span>cj <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/sf/man/st_geometry.html">st_set_geometry</a></span>(<span class="ot">NULL</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb35-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="dt">hour =</span> <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span>(time, <span class="dv">1</span>, <span class="dv">2</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb35-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(</a>
<a class="sourceLine" id="cb35-7" data-line-number="7">    <span class="dt">walking =</span> <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(walking),</a>
<a class="sourceLine" id="cb35-8" data-line-number="8">    <span class="dt">cycling =</span> <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(cycling),</a>
<a class="sourceLine" id="cb35-9" data-line-number="9">    <span class="dt">passenger =</span> <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(passenger)</a>
<a class="sourceLine" id="cb35-10" data-line-number="10">    ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb35-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span>(mode, casualties, <span class="op">-</span>hour)</a>
<a class="sourceLine" id="cb35-12" data-line-number="12"></a>
<a class="sourceLine" id="cb35-13" data-line-number="13"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(crash_times, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(hour, casualties)) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-14" data-line-number="14"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">colour =</span> mode))</a></code></pre></div>
<p><img src="stats19_files/figure-html/crash-time-plot-1.png" width="100%"></p>
<p>Note that bike crashes tend to have distinct morning and afternoon peaks, in-line with previous research <span class="citation">(Lovelace, Roberts, and Kellar 2016)</span>. A disproportionate number of car crashes appear to happen in the afternoon.</p>
</div>
<div id="further-work" class="section level2">
<h2 class="hasAnchor">
<a href="#further-work" class="anchor"></a>Further work</h2>
<p>There is much potential to extend the package beyond downloading, reading and formatting STATS19 data. The greatest potential is to provide functions that will help with analysis of STATS19 data, to help with road safety research. Much academic research has been done using the data, a few examples of which are highlighted below to demonstrate the wide potential for further work.</p>
<ul>
<li>Research exploring the effectiveness of road safety policies such as speed limits. An example in this area is <span class="citation">Grundy et al. (2009)</span>, who found that areas with 20mph speed limits were safer. This raises the question: can the same result be repeated using reproducible methods? Does the finding hold for more recent 20 mph zones? Is the recent finding of the Department for Transport’s (<a href="https://www.gov.uk/government/publications/20-mph-speed-limits-on-roads">2018</a>) research, that 20 mph zones alone do not reduce crash rates, supported by reproducible analysis? What are the factors that make speed limits more or less effective <span class="citation">(see Sarkar, Webster, and Kumari 2018 for example)</span>?</li>
<li>Research into weather as a contributing factor to road traffic casualties <span class="citation">(e.g. Edwards 1998)</span>. This raises the question: could matching crash data from the STATS19 data with historic weather data from other R packages help advance knowledge in this area?</li>
<li>Assessment of crash rates normalised by estimated exposure rates (risk). An example of this type of research by an author of the package found substantial spatial variation in the number of cyclist casualties across West Yorkshire <span class="citation">(Lovelace, Roberts, and Kellar 2016)</span>. This raises the questions: are similar spatial differences found in other regions? What are the factors leading to relatively high and low rates of different types of crash?</li>
</ul>
<p>The broader point is that the <strong>stats19</strong> package could help road safety research, by making open access data on road crashes more accessible to researchers worldwide. By easing the data download and cleaning stages of research, it could also encourage reproducible analysis in the field.</p>
<p>There is great potential to add value to and gain insight from the data by joining the datasets with open data, for example from the Consumer Data Research Centre (<a href="https://www.cdrc.ac.uk/">CDRC</a>, which funded this research), OpenStreetMap and the UK’s Ordnance Survey. If you have any suggestions on priorities for these future directions of (hopefully safe) travel, please get in touch on at <a href="https://github.com/ITSLeeds/stats19/issues">github.com/ITSLeeds/stats19/issues</a>.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-edwards_relationship_1998">
<p>Edwards, Julia B. 1998. “The Relationship Between Road Accident Severity and Recorded Weather.” <em>Journal of Safety Research</em> 29 (4): 249–62. <a href="https://doi.org/10.1016/S0022-4375(98)00051-6" class="uri">https://doi.org/10.1016/S0022-4375(98)00051-6</a>.</p>
</div>
<div id="ref-elvik_handbook_2009">
<p>Elvik, Rune, Truls Vaa, Alena Erke, and Michael Sorensen. 2009. <em>The Handbook of Road Safety Measures</em>. Emerald Group Publishing.</p>
</div>
<div id="ref-feleke_comparative_2018">
<p>Feleke, Robel, Shaun Scholes, Malcolm Wardlaw, and Jennifer S. Mindell. 2018. “Comparative Fatality Risk for Different Travel Modes by Age, Sex, and Deprivation.” <em>Journal of Transport &amp; Health</em> 8 (March): 307–20. <a href="https://doi.org/10.1016/j.jth.2017.08.007" class="uri">https://doi.org/10.1016/j.jth.2017.08.007</a>.</p>
</div>
<div id="ref-grundy_effect_2009">
<p>Grundy, Chris, Rebecca Steinbach, Phil Edwards, Judith Green, Ben Armstrong, and Paul Wilkinson. 2009. “Effect of 20 Mph Traffic Speed Zones on Road Injuries in London, 1986-2006: Controlled Interrupted Time Series Analysis.” <em>BMJ</em> 339 (December): b4469. <a href="https://doi.org/10.1136/bmj.b4469" class="uri">https://doi.org/10.1136/bmj.b4469</a>.</p>
</div>
<div id="ref-lovelace_who_2016">
<p>Lovelace, Robin, Hannah Roberts, and Ian Kellar. 2016. “Who, Where, When: The Demographic and Geographic Distribution of Bicycle Crashes in West Yorkshire.” <em>Transportation Research Part F: Traffic Psychology and Behaviour</em>, Bicycling and bicycle safety, 41, Part B. <a href="https://doi.org/10.1016/j.trf.2015.02.010" class="uri">https://doi.org/10.1016/j.trf.2015.02.010</a>.</p>
</div>
<div id="ref-sarkar_street_2018">
<p>Sarkar, Chinmoy, Chris Webster, and Sarika Kumari. 2018. “Street Morphology and Severity of Road Casualties: A 5-Year Study of Greater London.” <em>International Journal of Sustainable Transportation</em> 12 (7): 510–25. <a href="https://doi.org/10.1080/15568318.2017.1402972" class="uri">https://doi.org/10.1080/15568318.2017.1402972</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#functions">Functions</a></li>
      <li><a href="#download-stats19-data">Download STATS19 data</a></li>
      <li><a href="#read-stats19-data">Read STATS19 data</a></li>
      <li><a href="#format-stats19-data">Format STATS19 data</a></li>
      <li><a href="#casualties-data">Casualties data</a></li>
      <li><a href="#vehicles-data">Vehicles data</a></li>
      <li><a href="#creating-geographic-crash-data">Creating geographic crash data</a></li>
      <li><a href="#joining-tables">Joining tables</a></li>
      <li><a href="#time-series-analysis">Time series analysis</a></li>
      <li><a href="#further-work">Further work</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Robin Lovelace, Malcolm Morgan, Layik Hama, Mark Padgham, RAC Foundation.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
